<template>
<div class="memberinfo-democratic">
    <Table ref="memberinfodemocratictable" :highlight-row="true" :style="{'marginTop':'8px'}" border :columns="tableCol" :data="lists"></Table>
</div>
</template>
<script>
export default {
    name : 'memberinfo-democratic',
    props: {
        viewdata : null
    },
    data(){
        return {
            tableCol :[{
                title : '开始日期',
                key : 'start_time'      
            },{
                title : '结束日期',
                key : 'end_time'      
            },{
                title : '评议结果',
                key : 'result'      
            },{
                title : '评议奖惩情况',
                key : 'desc'
            },{
                title : '评议奖惩原因',
                key : 'reason'
            }],
            currentData: null,
            lists:[]
        }
    },
    methods: {
        fetchList(uid){
            return this.axios({
                method: 'get',
                url: '/v1/discuss/list',
                params: {
                    uid: uid
                }
            })
        }
    },
    watch:{
        viewdata(newVal, oldVal){
            this.currentData = newVal
        }
    },
    mounted(){
        let _this = this;
        this.currentData = this.viewdata;
        let id = this.currentData.id
        this.fetchList(id).then(res => {
            console.log(res)
            if (res.data.code == 200) {
                _this.lists = res.data.data
            };
        })
        .catch(err => {
            this.$Message.error('网络请求异常');
        });
    }
}
</script>
<style scoped>
.memberinfo-democratic{
    height: 100%;
    padding: 8px;
}
</style>