<!--党组织管理/批量修改弹窗-->
<template>
  <div class="BatchUpdate">
    <Modal
      v-model="modal1"
      title="批量修改"
      width="950"
      :loading="loading"
      :mask-closable=false
      @on-ok="handleSubmit('BatchUpdateForm')"
      @on-cancel="cancel">
      <Form ref="BatchUpdateForm" :model="BatchUpdateForm" :rules="ruleValidate"  inline label-position="top">
        <Row>
          <!-- <Col span="8">
            <FormItem label="选择信息集：" prop="infoSet"  style="width: 95%;">
              <Select v-model="BatchUpdateForm.infoSet" placeholder="请选择信息集">
                <Option value="0">基本信息</Option>
                <Option value="1">联系方式</Option>
              </Select>
            </FormItem>
          </Col> -->
          <Col span="8">
            <FormItem label="选择信息集/信息项：" prop="infoSet"  style="width: 95%;">
              <Cascader :data="data" v-model="value1"></Cascader>
            </FormItem>
          </Col>
          <!-- <Col span="8">
            <FormItem label="选择信息项：" prop="infoOption"  style="width: 95%;">
              <Select v-model="BatchUpdateForm.infoOption" placeholder="请选择信息集">
                <Option value="0">党组织代码</Option>
                <Option value="1">党组织类型</Option>
              </Select>
            </FormItem>
          </Col>  -->
          <Col span="6">
            <FormItem label="修改值：" prop="updateValue" style="width: 95%;">
              <Input v-model="BatchUpdateForm.updateValue" placeholder="请输入"></Input>
            </FormItem>
          </Col>
        </Row>
        <Row>
          <Table border :columns="columns1" :data="data1"></Table>
        </Row>
      </Form>
    </Modal>
  </div>
</template>
<script>
  export default {
    name:'CombinationQuery',
    data () {
      return {
        modal1: true,//是否显示弹窗
        loading: true,
        dept_id:this.$route.query.dept_id,
        BatchUpdateForm: {  //form的绑定
          revoketDate:'',//撤销时间
        },
        ruleValidate: {
          infoSet: [
            {required: true, message: '请选择基本信息集', trigger: 'change'}
          ],
          infoOption: [
            {required: true, message: '请选择基本信息项', trigger: 'change'}
          ],
          updateValue: [
            {required: true, message: '修改值不能为空', trigger: 'blur'}
          ]
        },
        columns1: [
          {
            type: 'selection',
            width: 40,
            align: 'center'
          },
          {
            title: '姓名',
            key: 'real_name'
          },
          {
            title: '性别',
            key: 'sex',
            
          },
          {
            title: '身份证号',
            key: 'idcard',
            width:200
          },
          {
            title: '民族',
            key: 'nation'
          },
          {
              title: '手机号码',
              key: 'mobile',
          },
        ],
        data1: [


        ]
      }
    },

    methods: {
      handleSubmit(name) {
        this.$refs[name].validate((valid) => {
            if (valid) {
              this.$Message.success('提交成功!');
              this.modal1=false;
            } else {
              this.loading=false;
          this.$Message.error('表单验证失败!');
          setTimeout(() => {
            this.loading=true;
        }, 20);
        }
        })
      },
      getPerson(id){
        let that = this;
        if(!id){return}
        that.axios({
          url:'/v1/member/applylist',
          method:'get',
          params:{
            dept_id: id,
            opt: 1 ,
          },
        })
        .then(res=>{
          let needData = res.data;
          if (needData.code == 200) {
            that.data1 = needData.data;
          } else {
              that.Message.error(needData.msg);
          }
        })
        .catch(err=>{
          this.Message.error('网络请求异常');
        })
      },
      cancel () {
        this.$router.push('/applicantManage/'+this.dept_id);
      }
    },
    mounted(){
      this.getPerson(this.dept_id)
    },
  }
</script>
<style>
  .box-wrap{
    width: 100%;
    height: 180px;
    border: 1px solid #dddee1;
    -webkit-border-radius: 2px;
    -moz-border-radius: 2px;
    border-radius: 2px;;
    margin-top: 20px;
  }
  .bold{
    font-weight: bold;
    font-size: 14px;
  }
  .fr{
    float: right;
  }
  .mr-5{
    margin-right: 10px;
    padding-left:25px ;
    padding-right:25px ;
  }
  .ml-10{
    margin-left: 10px;
  }
  .mb10{
    margin-bottom: 10px;
  }
 .w100{
   width: 100px;
 }
</style>
